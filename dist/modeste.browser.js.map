{"version":3,"file":"modeste.browser.js","sources":["../src/constants.js","../src/component/shouldUpdateData.js","../src/component/shouldUpdateProps.js","../src/utils/shallowCompare.js","../src/component/registerHooks.js","../src/component/emitHook.js","../src/dom/addStyles.js","../src/utils/generateId.js","../src/component/getScope.js","../src/component/registerComponent.js","../src/vDom/createElementNode.js","../src/utils/toKebabCase.js","../src/vDom/createComponentNode.js","../src/vDom/addClass.js","../src/component/createComponent.js","../src/component/emitMount.js","../src/dom/createDom.js","../src/utils/assign.js","../src/component/setProps.js","../src/component/removeComponent.js","../src/dom/updateDom.js","../src/dom/updateComponentDom.js","../src/dom/sameTypeAndTag.js","../src/utils/ModesteError.js","../src/component/render.js","../src/utils/immediateCall.js","../src/utils/promiseCall.js","../src/utils/timeoutCall.js","../src/utils/asyncCall.js","../src/component/asyncRender.js","../src/component/Component.js","../src/main.js"],"sourcesContent":["export const ROOT_NAME = 'modesteRoot';\nexport const INTERNAL_VAR_NAME = '__modesteInternal';\n\nexport const COMMENT_NODE = window.Node.COMMENT_NODE;\nexport const ELEMENT_NODE = window.Node.ELEMENT_NODE;\nexport const TEXT_NODE = window.Node.TEXT_NODE;\n","export default function shouldUpdateData(oldValue, newValue) {\n  return oldValue !== newValue;\n}\n","import shallowCompare from '../utils/shallowCompare';\n\nexport default function shouldUpdateProps(oldProps, newProps) {\n  return !shallowCompare(oldProps, newProps);\n}\n","export default function shallowCompare(a, b) {\n  let aKeys = Object.keys(a);\n  let bKeys = Object.keys(b);\n\n  if (aKeys.length !== bKeys.length) return false;\n\n  for (let i = 0; i < aKeys.length; i++) {\n    let key = aKeys[i];\n    let index = bKeys.indexOf(key);\n\n    if (index < 0) return false;\n    if (a[key] !== b[key]) return false;\n  }\n\n  return true;\n}\n","import { INTERNAL_VAR_NAME as m } from '../constants';\n\nconst HOOKS = [\n  'willCreate',\n  'didCreate',\n  'willMount',\n  'didMount',\n  'willUpdate',\n  'didUpdate',\n  'willRemove',\n  'didRemove',\n  'shouldUpdateData',\n  'shouldUpdateProps'\n];\n\nexport default function registerHooks(component, manifest) {\n  HOOKS.forEach(hook => {\n    if (manifest[hook]) component[m][hook] = manifest[hook].bind(component);\n  });\n}\n","import { INTERNAL_VAR_NAME as m } from '../constants';\n\nexport default function emitHook(component, hook) {\n  if (component[m][hook]) component[m][hook]();\n}\n","export default function addStyles(style, scope) {\n  if (!style) return;\n\n  let styleElement = document.createElement('style');\n\n  if (scope) {\n    let regex = /:scoped([^\\w\\d])/gm;\n    let repl = '.' + scope + '$1';\n\n    styleElement.textContent = style.replace(regex, repl);\n  } else {\n    styleElement.textContent = style;\n  }\n\n  document.head.appendChild(styleElement);\n\n  return styleElement;\n}\n","const ID_RND_LENGTH = 8;\nlet idCounter = 0;\n\nexport default function generateId(middleware) {\n  let random = Math.random()\n    .toString(36)\n    .substr(2, ID_RND_LENGTH);\n\n  let id =\n    random +\n    '0'.repeat(ID_RND_LENGTH - random.length) +\n    (idCounter++).toString(36);\n\n  if (middleware) return middleware(id);\n  return id;\n}\n","export default function getScope(id) {\n  return `__${id}__`;\n}\n","import { INTERNAL_VAR_NAME as m } from '../constants';\nimport Component from './Component';\nimport addStyles from '../dom/addStyles';\nimport generateId from '../utils/generateId';\nimport getScope from './getScope';\n\nlet factories = {};\n\nexport default function registerComponent(parent, name, manifest) {\n  if (!manifest[m]) {\n    let id = generateId();\n    let scope = manifest.scoped !== false ? getScope(id) : false;\n\n    manifest[m] = { id, scope };\n    if (manifest.style) addStyles(manifest.style(), scope);\n\n    factories[id] = (name, props, parent) =>\n      new Component(manifest, name, props, parent);\n  }\n\n  parent[m].factories[name] = factories[manifest[m].id];\n}\n","import toKebabCase from '../utils/toKebabCase';\n\nexport default function createElementNode(tag, opts, children) {\n  let props = {};\n  let attrs = {};\n\n  let node = { tag, props, attrs };\n\n  if (opts) {\n    if (opts instanceof Array) {\n      children = opts;\n    } else {\n      Object.keys(opts).forEach(key => {\n        switch (key[0]) {\n          case '_':\n            attrs[toKebabCase(key.substr(1))] = opts[key];\n            break;\n          case '$':\n            node[key.substr(1)] = opts[key];\n            break;\n          default:\n            props[key] = opts[key];\n        }\n      });\n    }\n  }\n\n  node.children = children ? children : [];\n\n  return node;\n}\n","export default function toKebabCase(str) {\n  let kebab = str.replace(/([A-Z])/g, '-$1').toLowerCase();\n  if (kebab[0] === '-') return kebab.substr(1);\n  return kebab;\n}\n","export default function createComponentNode(component, opts) {\n  let props = {};\n  let node = { component, props };\n\n  if (opts) {\n    Object.keys(opts).forEach(key => {\n      switch (key[0]) {\n        case '$':\n          node[key.substr(1)] = opts[key];\n          break;\n        default:\n          props[key] = opts[key];\n      }\n    });\n  }\n\n  return node;\n}\n","export default function addClass(vDom, className) {\n  if (!vDom || typeof vDom === 'string' || vDom.component || !className) return;\n  if (!vDom.props.className) vDom.props.className = '';\n  if (!vDom.attrs.class) vDom.attrs.class = '';\n\n  vDom.props.className = `${vDom.props.className} ${className}`.trim();\n  vDom.attrs.class = `${vDom.attrs.class} ${className}`.trim();\n}\n","import { INTERNAL_VAR_NAME as m } from '../constants';\n\nexport default function createComponent(name, props, parentComponent) {\n  return parentComponent[m].factories[name](name, props, parentComponent);\n}\n","import { INTERNAL_VAR_NAME as m } from '../constants';\nimport emitHook from './emitHook';\n\nexport default function emitMount(component) {\n  let children = component[m].children;\n  Object.keys(children).forEach(key => emitMount(children[key]));\n\n  component[m].mounted = true;\n  emitHook(component, 'didMount');\n}\n","import { INTERNAL_VAR_NAME as m } from '../constants';\nimport addClass from '../vDom/addClass';\nimport createComponent from '../component/createComponent';\nimport render from '../component/render';\nimport emitMount from '../component/emitMount';\n\nexport default function createDom(vDom, parent) {\n  if (parent) addClass(vDom, parent[m].scope);\n\n  if (!vDom) {\n    return document.createComment('');\n  }\n\n  switch (typeof vDom) {\n    case 'string':\n      return document.createTextNode(vDom);\n\n    case 'object':\n      if (vDom.component) {\n        let component = createComponent(vDom.component, vDom.props, parent);\n\n        if (vDom.ref) vDom.ref(component);\n\n        render(component);\n\n        if (vDom.key !== undefined) {\n          component[m].dom[m].key = vDom.key;\n        }\n        return component[m].dom;\n      }\n\n      let dom = document.createElement(vDom.tag);\n\n      dom[m] = {};\n      dom[m].attrs = {};\n      dom[m].props = {};\n\n      Object.keys(vDom.attrs).forEach(attr => {\n        if (vDom.attrs[attr] !== null) {\n          dom.setAttribute(attr, vDom.attrs[attr]);\n          dom[m].attrs[attr] = vDom.attrs[attr];\n        }\n      });\n\n      Object.keys(vDom.props).forEach(prop => {\n        if (vDom.props[prop] !== null) {\n          dom[prop] = vDom.props[prop];\n          dom[m].props[prop] = vDom.props[prop];\n        }\n      });\n\n      vDom.children.forEach(child => {\n        let childDom = createDom(child, parent);\n        dom.appendChild(childDom);\n\n        if (parent && parent[m].mounted && childDom[m] && childDom[m].id) {\n          emitMount(parent[m].children[childDom[m].id]);\n        }\n      });\n\n      if (vDom.ref) vDom.ref(dom);\n      if (vDom.key !== undefined) dom[m].key = vDom.key;\n\n      return dom;\n  }\n}\n","export default function assign() {\n  for (let i = 1; i < arguments.length; i++) {\n    Object.keys(arguments[i]).forEach(key => {\n      arguments[0][key] = arguments[i][key];\n    });\n  }\n  return arguments[0];\n}\n","import { INTERNAL_VAR_NAME as m } from '../constants';\nimport render from './render';\nimport assign from '../utils/assign';\n\nexport default function setProps(component, props) {\n  let newProps = component[m].defaultProps\n    ? assign({}, component[m].defaultProps, props)\n    : props;\n\n  if (component[m].shouldUpdateProps(component[m].props, newProps)) {\n    component[m].props = newProps;\n    render(component);\n  }\n}\n","import { INTERNAL_VAR_NAME as m } from '../constants';\nimport emitHook from './emitHook';\n\nexport default function removeComponent(component) {\n  emitHook(component, 'willRemove');\n\n  let parent = component[m].parent;\n  let id = component[m].id;\n\n  Object.keys(component[m].children).forEach(child => {\n    removeComponent(child);\n  });\n\n  component[m].subscriptions.forEach(item => {\n    let store = item.store;\n    item.fields.forEach(field => {\n      if (store[m].data.hasOwnProperty(field))\n        delete store[m].subscribers[field][id];\n    });\n  });\n\n  component[m].mounted = false;\n  delete component[m].dom;\n  if (parent) delete parent[m].children[id];\n\n  emitHook(component, 'didRemove');\n}\n","import { INTERNAL_VAR_NAME as m, ELEMENT_NODE, TEXT_NODE } from '../constants';\nimport addClass from '../vDom/addClass';\nimport sameTypeAndTag from './sameTypeAndTag';\nimport updateComponentDom from './updateComponentDom';\nimport createDom from './createDom';\nimport removeComponent from '../component/removeComponent';\nimport emitMount from '../component/emitMount';\n\nexport default function updateDom(dom, vDom, parentComponent) {\n  if (vDom && vDom.component) {\n    updateComponentDom(dom, vDom, parentComponent);\n    return;\n  }\n\n  if (!sameTypeAndTag(dom, vDom)) {\n    if (dom[m] && dom[m].id) {\n      removeComponent(parentComponent[m].children[dom[m].id]);\n    }\n\n    let newDom = createDom(vDom, parentComponent);\n    dom.parentNode.replaceChild(newDom, dom);\n\n    if (parentComponent && parentComponent[m].dom === dom) {\n      parentComponent[m].dom = newDom;\n    }\n\n    return;\n  }\n\n  if (parentComponent) addClass(vDom, parentComponent[m].scope);\n\n  switch (dom.nodeType) {\n    case ELEMENT_NODE:\n      // Process attrs\n      let attrs = [];\n\n      if (dom[m].attrs) {\n        Object.keys(dom[m].attrs).forEach(attr => {\n          attrs.push(attr);\n        });\n      }\n\n      if (!dom[m].attrs) dom[m].attrs = {};\n\n      Object.keys(vDom.attrs).forEach(attr => {\n        if (vDom.attrs[attr] === null) {\n          dom.removeAttribute(attr);\n          delete dom[m].attrs[attr];\n        } else if (dom[m].attrs[attr] !== vDom.attrs[attr]) {\n          dom.setAttribute(attr, vDom.attrs[attr]);\n          dom[m].attrs[attr] = vDom.attrs[attr];\n        }\n\n        let index = attrs.indexOf(attr);\n        if (index > -1) {\n          attrs.splice(index, 1);\n        }\n      });\n\n      attrs.forEach(attr => {\n        dom.removeAttribute(attr);\n        delete dom[m].attrs[attr];\n      });\n\n      // Process props\n      let props = [];\n\n      if (dom[m].props) {\n        Object.keys(dom[m].props).forEach(prop => {\n          props.push(prop);\n        });\n      }\n\n      if (!dom[m].props) dom[m].props = {};\n\n      Object.keys(vDom.props).forEach(prop => {\n        if (vDom.props[prop] === null) {\n          dom[prop] = null;\n          delete dom[m].props[prop];\n        } else if (dom[m].props[prop] !== vDom.props[prop]) {\n          dom[prop] = vDom.props[prop];\n          dom[m].props[prop] = vDom.props[prop];\n        }\n\n        let index = props.indexOf(prop);\n        if (index > -1) {\n          props.splice(index, 1);\n        }\n      });\n\n      props.forEach(prop => {\n        dom[prop] = null;\n        delete dom[m].props[prop];\n      });\n\n      // Process child nodes\n      let keyed = vDom.children[0] && vDom.children[0].key !== undefined;\n\n      if (keyed) {\n        let nodes = {};\n        let vNodes = {};\n\n        vDom.children.forEach(child => {\n          vNodes[child.key] = child;\n        });\n\n        while (dom.firstChild) {\n          nodes[dom.firstChild[m].key] = dom.removeChild(dom.firstChild);\n        }\n\n        vDom.children.forEach(child => {\n          if (nodes[child.key]) {\n            dom.appendChild(nodes[child.key]);\n            updateDom(nodes[child.key], child, parentComponent);\n          } else {\n            appendNewDomAndMount(child, dom, parentComponent);\n          }\n        });\n      } else {\n        vDom.children.forEach((child, index) => {\n          if (!dom.childNodes[index]) {\n            appendNewDomAndMount(child, dom, parentComponent);\n          } else {\n            updateDom(dom.childNodes[index], child, parentComponent);\n          }\n        });\n\n        while (dom.childNodes[vDom.children.length]) {\n          let child = dom.childNodes[vDom.children.length];\n          dom.removeChild(child);\n        }\n      }\n\n      // Run ref function\n      if (vDom.ref) vDom.ref(dom);\n\n      // Store the key\n      if (vDom.key) dom[m].key = vDom.key;\n      else if (dom[m].key) delete dom[m].key;\n\n      break;\n\n    case TEXT_NODE:\n      if (dom.nodeValue !== vDom) {\n        dom.nodeValue = vDom;\n      }\n      break;\n  }\n}\n\nfunction appendNewDomAndMount(vDom, parentDom, parentComponent) {\n  let childDom = createDom(vDom, parentComponent);\n  parentDom.appendChild(childDom);\n\n  if (\n    parentComponent &&\n    parentComponent[m].mounted &&\n    childDom[m] &&\n    childDom[m].id\n  ) {\n    emitMount(parentComponent[m].children[childDom[m].id]);\n  }\n}\n","import { INTERNAL_VAR_NAME as m } from '../constants';\nimport createComponent from '../component/createComponent';\nimport setProps from '../component/setProps';\nimport render from '../component/render';\nimport emitMount from '../component/emitMount';\nimport removeComponent from '../component/removeComponent';\n\nexport default function updateComponentDom(dom, vDom, parent) {\n  if (dom[m] && dom[m].id) {\n    let id = dom[m].id;\n    let component = parent[m].children[id];\n\n    if (component[m].name === vDom.component) {\n      component[m].dom = dom;\n      setProps(component, vDom.props);\n\n      if (vDom.ref) vDom.ref(component);\n\n      return;\n    } else {\n      removeComponent(parent[m].children[id]);\n    }\n  }\n\n  let component = createComponent(vDom.component, vDom.props, parent);\n\n  component[m].dom = dom;\n\n  if (vDom.ref) vDom.ref(component);\n\n  render(component);\n\n  if (vDom.key !== undefined) component[m].dom[m].key = vDom.key;\n  else if (component[m].dom[m].key !== undefined)\n    delete component[m].dom[m].key;\n\n  if (parent[m].mounted) emitMount(component);\n}\n","import { COMMENT_NODE, ELEMENT_NODE, TEXT_NODE } from '../constants';\n\nexport default function sameTypeAndTag(dom, vDom) {\n  if (!vDom) return dom.nodeType === COMMENT_NODE;\n\n  if (typeof vDom === 'object' && dom.nodeType === ELEMENT_NODE) {\n    return vDom.tag.toUpperCase() === dom.tagName;\n  } else if (typeof vDom === 'string' && dom.nodeType === TEXT_NODE) {\n    return true;\n  }\n\n  return false;\n}\n","export default class ModesteError extends Error {\n  constructor(...args) {\n    super(...args);\n    this.name = 'MODESTE Error';\n    this.message = '[MODESTE ERROR] ' + this.message;\n    Error.captureStackTrace(this, ModesteError);\n  }\n}\n","import { INTERNAL_VAR_NAME as m } from '../constants';\nimport emitHook from './emitHook';\nimport e from '../vDom/createElementNode';\nimport c from '../vDom/createComponentNode';\nimport createDom from '../dom/createDom';\nimport updateDom from '../dom/updateDom';\nimport ModesteError from '../utils/ModesteError';\n\nexport default function render(component) {\n  if (component[m].render) {\n    if (!component[m].mounted) emitHook(component, 'willMount');\n    else emitHook(component, 'willUpdate');\n\n    let vDom = component[m].render(e, c);\n\n    if (typeof vDom !== 'object' || vDom.component || !vDom.tag) {\n      throw new ModesteError(\n        `${component[m].name}: Component root must be a tag`\n      );\n    }\n\n    if (!component[m].dom) {\n      component[m].dom = createDom(vDom, component);\n    } else {\n      if (component[m].dom[m] && component[m].dom[m].key !== undefined) {\n        vDom.key = component[m].dom[m].key;\n      }\n\n      updateDom(component[m].dom, vDom, component);\n    }\n\n    component[m].dom[m].id = component[m].id;\n\n    if (component[m].mounted) emitHook(component, 'didUpdate');\n  } else emitHook(component, 'didUpdate');\n}\n","export default function immediateCall(func, callback) {\n  window.setImmediate(function() {\n    func();\n    if (callback) callback();\n  });\n}\n","const resolvedPromise = Promise.resolve();\n\nexport default function promiseCall(func, callback) {\n  return resolvedPromise.then(function() {\n    func();\n    if (callback) callback();\n  });\n}\n","export default function timeoutCall(func, callback) {\n  setTimeout(function() {\n    func();\n    if (callback) callback();\n  }, 0);\n}\n","import immediateCall from './immediateCall';\nimport promiseCall from './promiseCall';\nimport timeoutCall from './timeoutCall';\n\nexport function chooseAsyncFunc() {\n  if (window.setImmediate) return immediateCall;\n  else if (window.Promise) return promiseCall;\n  else return timeoutCall;\n}\n\nexport default chooseAsyncFunc();\n","import { INTERNAL_VAR_NAME as m } from '../constants';\nimport render from './render';\nimport asyncCall from '../utils/asyncCall';\n\nlet renderQueue = [];\nlet rendered = {};\n\nfunction flushRender() {\n  renderQueue.forEach(component => {\n    if (!rendered[component[m].id]) {\n      render(component);\n      rendered[component[m].id] = true;\n    }\n  });\n\n  renderQueue = [];\n  rendered = {};\n}\n\nexport default function asyncRender(component, callback) {\n  renderQueue.push(component);\n  if (renderQueue.length === 1) asyncCall(flushRender, callback);\n}\n","import { INTERNAL_VAR_NAME as m } from '../constants';\nimport shouldUpdateData from './shouldUpdateData';\nimport shouldUpdateProps from './shouldUpdateProps';\nimport registerHooks from './registerHooks';\nimport emitHook from './emitHook';\nimport registerComponent from './registerComponent';\nimport render from './render';\nimport asyncRender from './asyncRender';\nimport generateId from '../utils/generateId';\nimport assign from '../utils/assign';\nimport getScope from './getScope';\n\nexport default class Component {\n  constructor(manifest, name, props, parent) {\n    let id = generateId();\n    let scope = false;\n\n    if (manifest.scoped !== false) {\n      scope = manifest[m] ? manifest[m].scope : getScope(generateId());\n    }\n\n    this[m] = {};\n    registerHooks(this, manifest);\n    emitHook(this, 'willCreate');\n\n    this[m].id = id;\n    if (parent) parent[m].children[id] = this;\n\n    this[m].name = name;\n    this[m].factories = {};\n    this[m].parent = parent;\n    this[m].app = parent ? parent[m].app : this;\n    this[m].scope = scope;\n    this[m].children = {};\n    this[m].props = props ? props : {};\n    this[m].defaultProps = manifest.defaultProps;\n\n    if (this[m].defaultProps)\n      this[m].props = assign({}, this[m].defaultProps, this[m].props);\n\n    this[m].subscribers = {};\n\n    this[m].subscriptions = manifest.subscriptions\n      ? manifest.subscriptions\n      : [];\n\n    this[m].render = manifest.render ? manifest.render.bind(this) : null;\n\n    this[m].shouldUpdateData = shouldUpdateData;\n    this[m].shouldUpdateProps = shouldUpdateProps;\n\n    this[m].subscriptions.forEach(item => {\n      let store = item.store;\n      item.fields.forEach(field => {\n        if (store[m].data.hasOwnProperty(field))\n          store[m].subscribers[field][id] = this;\n      });\n    });\n\n    if (manifest.props) {\n      manifest.props.forEach(prop => {\n        Object.defineProperty(this, prop, {\n          enumerable: true,\n          get: function() {\n            return this[m].props[prop] !== undefined &&\n              this[m].props[prop] !== null\n              ? this[m].props[prop]\n              : this[m].defaultProps[prop];\n          }\n        });\n      });\n    }\n\n    if (manifest.data) {\n      this[m].data = manifest.data.bind(this)();\n\n      Object.keys(this[m].data).forEach(prop => {\n        this[m].subscribers[prop] = {};\n\n        Object.defineProperty(this, prop, {\n          enumerable: true,\n          get: function() {\n            return this[m].data[prop];\n          },\n          set: function(value) {\n            if (this[m].shouldUpdateData(this[m].data[prop], value)) {\n              this[m].data[prop] = value;\n              asyncRender(this);\n\n              let subscribers = this[m].subscribers[prop];\n              Object.keys(subscribers).forEach(key =>\n                asyncRender(subscribers[key])\n              );\n            }\n          }\n        });\n      });\n    }\n\n    if (manifest.components) {\n      Object.keys(manifest.components).forEach(name => {\n        registerComponent(this, name, manifest.components[name]);\n      });\n    }\n\n    if (manifest.methods) {\n      Object.keys(manifest.methods).forEach(method => {\n        this[method] = manifest.methods[method].bind(this);\n      });\n    }\n\n    emitHook(this, 'didCreate');\n  }\n\n  get $data() {\n    return assign({}, this[m].data);\n  }\n\n  set $data(data) {\n    Object.keys(data).forEach(key => {\n      if (this[m].data !== undefined) this[key] = data[key];\n    });\n  }\n\n  get $props() {\n    return assign({}, this[m].props);\n  }\n\n  get $app() {\n    return this[m].app;\n  }\n\n  get $dom() {\n    return this[m].dom;\n  }\n\n  $render() {\n    render(this);\n  }\n}\n","import { ROOT_NAME, INTERNAL_VAR_NAME as m } from './constants';\nimport Component from './component/Component';\nimport addStyles from './dom/addStyles';\nimport emitMount from './component/emitMount';\nimport setProps from './component/setProps';\n\nexport default class Modeste extends Component {\n  constructor(manifest, props) {\n    super(manifest, ROOT_NAME, props);\n    this[m].isApp = true;\n\n    if (manifest.style) addStyles(manifest.style(), this[m].scope);\n    this[m].wrap = manifest.selector\n      ? document.querySelector(manifest.selector)\n      : null;\n\n    this.$render();\n  }\n\n  get $wrap() {\n    return this[m].wrap;\n  }\n\n  set $props(props) {\n    setProps(this, props);\n  }\n\n  $render() {\n    super.$render();\n\n    if (!this[m].render) return;\n\n    if (!this[m].mounted) {\n      if (!this[m].wrap) return emitMount(this);\n\n      while (this[m].wrap.firstChild)\n        this[m].wrap.removeChild(this[m].wrap.firstChild);\n\n      this[m].wrap.appendChild(this[m].dom);\n      emitMount(this);\n    }\n  }\n}\n"],"names":["INTERNAL_VAR_NAME","COMMENT_NODE","window","Node","ELEMENT_NODE","TEXT_NODE","shouldUpdateData","oldValue","newValue","shouldUpdateProps","oldProps","newProps","a","b","aKeys","Object","keys","bKeys","length","i","key","indexOf","shallowCompare","HOOKS","emitHook","component","hook","m","addStyles","style","scope","styleElement","document","createElement","repl","textContent","replace","head","appendChild","ID_RND_LENGTH","idCounter","generateId","middleware","random","Math","toString","substr","id","repeat","getScope","factories","createElementNode","tag","opts","children","props","attrs","node","Array","forEach","str","kebab","toLowerCase","createComponentNode","addClass","vDom","className","class","trim","createComponent","name","parentComponent","emitMount","mounted","createDom","parent","createComment","createTextNode","ref","undefined","dom","attr","setAttribute","prop","childDom","child","assign","_arguments","arguments","setProps","defaultProps","removeComponent","subscriptions","store","item","fields","data","hasOwnProperty","field","subscribers","updateDom","nodeType","toUpperCase","tagName","newDom","parentNode","replaceChild","push","removeAttribute","index","splice","nodes","vNodes","firstChild","removeChild","childNodes","nodeValue","appendNewDomAndMount","parentDom","ModesteError","args","message","_this","captureStackTrace","Error","render","e","c","immediateCall","func","callback","setImmediate","resolvedPromise","Promise","resolve","promiseCall","then","timeoutCall","rendered","flushRender","asyncRender","renderQueue","asyncCall","Component","manifest","scoped","this","bind","app","defineProperty","value","components","methods","method","_this2","isApp","wrap","selector","querySelector","$render"],"mappings":"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"}