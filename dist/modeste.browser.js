var Modeste=function(){"use strict";var e="modesteRoot",c="__modesteInternal";function s(t,e){return t===e}function a(t,e,r){for(var o=void 0;o=(Math.random()*t).toFixed(0),r&&(o=r(o)),e[o];);return e[o]=!0,o}var p="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},o=function(t){function i(){var t;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i);for(var e=arguments.length,r=Array(e),o=0;o<e;o++)r[o]=arguments[o];var n=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(t=i.__proto__||Object.getPrototypeOf(i)).call.apply(t,[this].concat(r)));return n.name="MODESTE Error",n.message="[MODESTE ERROR] "+n.message,Error.captureStackTrace(n,modesteError),n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(i,Error),i}();function f(t,e){if(t){var r=document.createElement("style"),o="."+e;return r.textContent=t.replace(/:\$/gm,o),document.head.appendChild(r),r}}function d(e,r){if(!e)return document.createComment("");switch(void 0===e?"undefined":p(e)){case"string":return document.createTextNode(e);case"object":if(h(e,r[c].scope),e.component){var t=l(e.component,e.props,r);return e.ref&&e.ref(t),v(t),t[c].dom}var o=document.createElement(e.tag);return o[c]={},o[c].attrs={},o[c].props={},Object.keys(e.attrs).forEach(function(t){null!==e.attrs[t]&&(o.setAttribute(t,e.attrs[t]),o[c].attrs[t]=e.attrs[t])}),Object.keys(e.props).forEach(function(t){null!==e.props[t]&&(o[t]=e.props[t],o[c].props[t]=e.props[t])}),e.children.forEach(function(t){m(t,r),o.appendChild(d(t,r))}),e.ref&&e.ref(o),o}}function u(r,o,n){if(h(o,n[c].scope),o&&o.component)!function(t,e,r){if(t[c]&&t[c].id){var o=t[c].id,n=r[c].children[o];if(e.props||(e.props={}),n[c].name===e.component)return n[c].dom=t,i=n,s=e.props,i[c].shouldUpdateProps(i.props,s)&&(i.props=s,v(i)),e.ref&&e.ref(n);r[c].removeChild(o)}var i,s;var a=l(e.component,e.props,r);a[c].dom=t,e.ref&&e.ref(a);v(a)}(r,o,n);else{if(!function(t,e){if(!e)return 8===t.nodeType;{if("object"===(void 0===e?"undefined":p(e))&&1===t.nodeType)return e.tag.toUpperCase()===t.tagName;if("string"==typeof e&&3===t.nodeType)return!0}return!1}(r,o)){r[c]&&r[c].id&&function e(t,r){if(t[c].children[r]){var o=t[c].children[r];E(o,"willRemove"),delete o[c].dom,Object.keys(o[c].children).forEach(function(t){e(t,o)}),E(o,"didRemove"),delete t[c].children[r]}}(n,r[c].id);var t=d(o,n);return r.parentNode.replaceChild(t,r),void(n[c].dom===r&&(n[c].dom=t))}switch(r.nodeType){case 1:var i=[];r[c].attrs&&Object.keys(r[c].attrs).forEach(function(t){i.push(t)}),r[c].attrs||(r[c].attrs={}),Object.keys(o.attrs).forEach(function(t){null===o.attrs[t]?(r.removeAttribute(t),delete r[c].attrs[t]):r[t]!==o.attrs[t]&&(r.setAttribute(t,o.attrs[t]),r[c].attrs[t]=o.attrs[t]);var e=i.indexOf(t);-1<e&&i.splice(e,1)}),i.forEach(function(t){r.removeAttribute(t),delete r[c].attrs[t]});var s=[];for(r[c].props&&Object.keys(r[c].props).forEach(function(t){s.push(t)}),r[c].props||(r[c].props={}),Object.keys(o.props).forEach(function(t){null===o.props[t]?(r[t]=null,delete r[c].props[t]):r[t]!==o.props[t]&&(r[t]=o.props[t],r[c].props[t]=o.props[t]);var e=s.indexOf(t);-1<e&&s.splice(e,1)}),s.forEach(function(t){r[t]=null,delete r[c].props[t]}),o.children||(o.children=[]),o.children.forEach(function(t,e){m(t,n),r.childNodes[e]?u(r.childNodes[e],t,n):r.appendChild(d(t,n))});r.childNodes[o.children.length];){var e=r.childNodes[o.children.length];r.removeChild(e)}o.ref&&o.ref(r);break;case 3:r.nodeValue!==o&&(r.nodeValue=o)}}}function l(t,e,r){return r[c].factories[t]?r[c].factories[t](e,r):r[c].app.factories[t](e,r)}function h(r,t){if(r&&"string"!=typeof r&&(r.children||(r.children=[]),r.props||(r.props={}),!r.component)){if(r.attrs){var o={};Object.keys(r.attrs).forEach(function(t){var e;o[(e=t,e.replace(/([A-Z])/g,"-$1").toLowerCase())]=r.attrs[t]}),r.attrs=o}else r.attrs={};r.props.className?(delete r.attrs.class,r.props.className=t+" "+r.props.className):r.attrs.class?r.attrs.class=t+" "+r.attrs.class:r.props.className=t}}function m(t,e){if(t){if("string"!=typeof t&&!t.tag&&!t.component)throw new o(e[c].name+': VDOM node must be a string or an object with "tag" or "component" property');if(t.children&&!(t.children instanceof Array))throw new o(e[c].name+': VDOM node "children" property must be an Array')}}var i=["willCreate","didCreate","willMount","didMount","willUpdate","didUpdate","willRemove","didRemove","shouldUpdateData","shouldUpdateProps"],t={};function y(e,t){var r,o,n=this;this[c]={},e.manifest.factories||(e.manifest.factories={}),this[c].factories=e.manifest.factories,this[c].app=t||this,this[c].name=e.name,this[c].id=e.id,this[c].scope=e.scope,this[c].children={},this[c].render=e.manifest.render.bind(this),this[c].shouldUpdateData=O,this[c].shouldUpdateProps=w,r=this,o=e.manifest,i.forEach(function(t){o[t]&&(r[c][t]=o[t].bind(r))}),E(this,"willCreate"),this.props=e.props?e.props:{},e.manifest.data&&(this[c].data=e.manifest.data(),Object.keys(this[c].data).forEach(function(e){return Object.defineProperty(n,e,{enumerable:!0,get:function(){return this[c].data[e]},set:function(t){this[c].shouldUpdateData(this[c].data[e],t)&&(this[c].data[e]=t,v(this))}})})),e.manifest.components&&Object.keys(e.manifest.components).forEach(function(t){!function(t,n,i){if(!t[c].factories[n]){var s=b(n);f(i.style(),s),t[c].factories[n]=function(t,e){var r=a(1e6,e[c].children),o=new y({name:n,manifest:i,scope:s,id:r,props:t},e[c].app);return e[c].children[r]=o}}}(n,t,e.manifest.components[t])}),e.manifest.methods&&Object.keys(e.manifest.methods).forEach(function(t){n[t]=e.manifest.methods[t].bind(n)}),E(this,"didCreate")}function b(e){return a(1e6,t,function(t){return e+t})}function v(t){var e=!t[c].dom;E(t,e?"willMount":"willUpdate");var r=t[c].render();if("object"!==(void 0===r?"undefined":p(r))||r.component||!r.tag)throw new o(t[c].name+": Component root must be a tag");e?t[c].dom=d(r,t):u(t[c].dom,r,t),t[c].dom[c].id=t[c].id,E(t,e?"didMount":"didUpdate")}function E(t,e){t[c][e]&&t[c][e]()}function O(t,e){return!s(t,e)}function w(t,e){!function(t,e){var r=Object.keys(t),o=Object.keys(e);if(r.length!==o.length)return;for(var n=0;n<r.length;n++){var i=r[n];if(o.indexOf(i)<0)return;if(!s(t[i],e[i]))return}}(t,e)}y.prototype.render=function(){v(this)};var r=b(e);function n(t){y.call(this,{name:e,id:e,manifest:t,scope:r}),t.style&&f(t.style(),r),this[c].wrap=document.querySelector(t.selector)}return((n.prototype=Object.create(y.prototype)).constructor=n).prototype.render=function(){y.prototype.render.call(this),0===this[c].wrap.childNodes.length&&this[c].wrap.appendChild(this[c].dom)},n}();
//# sourceMappingURL=modeste.browser.js.map
