var Modeste=function(){"use strict";var y="__modesteInternal",p=window.Node.COMMENT_NODE,f=window.Node.ELEMENT_NODE,l=window.Node.TEXT_NODE;function m(e,t){return e!==t}function b(e,t){return!function(e,t){var r=Object.keys(e),o=Object.keys(t);if(r.length!==o.length)return!1;for(var n=0;n<r.length;n++){var i=r[n];if(o.indexOf(i)<0)return!1;if(e[i]!==t[i])return!1}return!0}(e,t)}var v=["willCreate","didCreate","willMount","didMount","willUpdate","didUpdate","willRemove","didRemove","shouldUpdateData","shouldUpdateProps"];function k(e,t){e[y][t]&&e[y][t]()}function O(e,t){if(e){var r=document.createElement("style");if(t){var o="."+t+"$1";r.textContent=e.replace(/:scoped([^\w\d])/gm,o)}else r.textContent=e;return document.head.appendChild(r),r}}var o=8,n=0;function E(e){var t=Math.random().toString(36).substr(2,o),r=t+"0".repeat(o-t.length)+(n++).toString(36);return e?e(r):r}function w(e){return"__"+e+"__"}var g={};function r(e,o,t){var n={},i={},s={tag:e,props:n,attrs:i};return o&&(o instanceof Array?t=o:Object.keys(o).forEach(function(e){switch(e[0]){case"_":i[(t=e.substr(1),r=t.replace(/([A-Z])/g,"-$1").toLowerCase(),"-"===r[0]?r.substr(1):r)]=o[e];break;case"$":s[e.substr(1)]=o[e];break;default:n[e]=o[e]}var t,r})),s.children=t||[],s}function i(e,t){var r={},o={component:e,props:r};return t&&Object.keys(t).forEach(function(e){switch(e[0]){case"$":o[e.substr(1)]=t[e];break;default:r[e]=t[e]}}),o}function h(e,t){e&&"string"!=typeof e&&!e.component&&t&&(e.props.className||(e.props.className=""),e.attrs.class||(e.attrs.class=""),e.props.className=(e.props.className+" "+t).trim(),e.attrs.class=(e.attrs.class+" "+t).trim())}function j(e,t,r){return r[y].factories[e](e,t,r)}function C(e){var t=e[y].children;Object.keys(t).forEach(function(e){return C(t[e])}),e[y].mounted=!0,k(e,"didMount")}var _="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},P=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},t=function(){function o(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(e,t,r){return t&&o(e.prototype,t),r&&o(e,r),e}}(),s=function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)},a=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t};function N(t,r){if(r&&h(t,r[y].scope),!t)return document.createComment("");switch(void 0===t?"undefined":_(t)){case"string":return document.createTextNode(t);case"object":if(t.component){var e=j(t.component,t.props,r);return t.ref&&t.ref(e),D(e),void 0!==t.key&&(e[y].dom[y].key=t.key),e[y].dom}var o=document.createElement(t.tag);return o[y]={},o[y].attrs={},o[y].props={},Object.keys(t.attrs).forEach(function(e){null!==t.attrs[e]&&(o.setAttribute(e,t.attrs[e]),o[y].attrs[e]=t.attrs[e])}),Object.keys(t.props).forEach(function(e){null!==t.props[e]&&(o[e]=t.props[e],o[y].props[e]=t.props[e])}),t.children.forEach(function(e){var t=N(e,r);o.appendChild(t),r&&r[y].mounted&&t[y]&&t[y].id&&C(r[y].children[t[y].id])}),t.ref&&t.ref(o),void 0!==t.key&&(o[y].key=t.key),o}}function T(){for(var r=arguments,e=function(t){Object.keys(r[t]).forEach(function(e){r[0][e]=r[t][e]})},t=1;t<arguments.length;t++)e(t);return arguments[0]}function $(e,t){Object.keys(t).forEach(function(e){void 0!==t[e]&&null!==t[e]||delete t[e]});var r=e[y].defaultProps?T({},e[y].defaultProps,t):t;e[y].shouldUpdateProps(e[y].props,r)&&(e[y].props=r,D(e))}function S(e){k(e,"willRemove");var t=e[y].parent,r=e[y].id;Object.keys(e[y].children).forEach(function(e){S(e)}),e[y].subscriptions.forEach(function(e){var t=e.store;e.fields.forEach(function(e){t[y].data.hasOwnProperty(e)&&delete t[y].subscribers[e][r]})}),e[y].mounted=!1,delete e[y].dom,t&&delete t[y].children[r],k(e,"didRemove")}function U(r,o,n){if(o&&o.component)!function(e,t,r){if(e[y]&&e[y].id){var o=e[y].id,n=r[y].children[o];if(n[y].name===t.component)return n[y].dom=e,$(n,t.props),t.ref&&t.ref(n);S(r[y].children[o])}var i=j(t.component,t.props,r);i[y].dom=e,t.ref&&t.ref(i),D(i),void 0!==t.key?i[y].dom[y].key=t.key:void 0!==i[y].dom[y].key&&delete i[y].dom[y].key,r[y].mounted&&C(i)}(r,o,n);else{if(t=r,!((i=o)?"object"===(void 0===i?"undefined":_(i))&&t.nodeType===f?i.tag.toUpperCase()===t.tagName:"string"==typeof i&&t.nodeType===l:t.nodeType===p)){r[y]&&r[y].id&&S(n[y].children[r[y].id]);var e=N(o,n);return r.parentNode.replaceChild(e,r),void(n&&n[y].dom===r&&(n[y].dom=e))}var t,i;switch(n&&h(o,n[y].scope),r.nodeType){case f:var s=[];r[y].attrs&&Object.keys(r[y].attrs).forEach(function(e){s.push(e)}),r[y].attrs||(r[y].attrs={}),Object.keys(o.attrs).forEach(function(e){null===o.attrs[e]?(r.removeAttribute(e),delete r[y].attrs[e]):r[y].attrs[e]!==o.attrs[e]&&(r.setAttribute(e,o.attrs[e]),r[y].attrs[e]=o.attrs[e]);var t=s.indexOf(e);-1<t&&s.splice(t,1)}),s.forEach(function(e){r.removeAttribute(e),delete r[y].attrs[e]});var a=[];if(r[y].props&&Object.keys(r[y].props).forEach(function(e){a.push(e)}),r[y].props||(r[y].props={}),Object.keys(o.props).forEach(function(e){null===o.props[e]?(r[e]=null,delete r[y].props[e]):r[y].props[e]!==o.props[e]&&(r[e]=o.props[e],r[y].props[e]=o.props[e]);var t=a.indexOf(e);-1<t&&a.splice(t,1)}),a.forEach(function(e){r[e]=null,delete r[y].props[e]}),o.children[0]&&void 0!==o.children[0].key){var c={},d={};for(o.children.forEach(function(e){d[e.key]=e});r.firstChild;)c[r.firstChild[y].key]=r.removeChild(r.firstChild);o.children.forEach(function(e){c[e.key]?(r.appendChild(c[e.key]),U(c[e.key],e,n)):M(e,r,n)})}else for(o.children.forEach(function(e,t){r.childNodes[t]?U(r.childNodes[t],e,n):M(e,r,n)});r.childNodes[o.children.length];){var u=r.childNodes[o.children.length];r.removeChild(u)}o.ref&&o.ref(r),o.key?r[y].key=o.key:r[y].key&&delete r[y].key;break;case l:r.nodeValue!==o&&(r.nodeValue=o)}}}function M(e,t,r){var o=N(e,r);t.appendChild(o),r&&r[y].mounted&&o[y]&&o[y].id&&C(r[y].children[o[y].id])}var x=function(e){function i(){var e;P(this,i);for(var t=arguments.length,r=Array(t),o=0;o<t;o++)r[o]=arguments[o];var n=a(this,(e=i.__proto__||Object.getPrototypeOf(i)).call.apply(e,[this].concat(r)));return n.name="MODESTE Error",n.message="[MODESTE ERROR] "+n.message,Error.captureStackTrace(n,i),n}return s(i,e),i}(Error);function D(e){if(e[y].render){e[y].mounted?k(e,"willUpdate"):k(e,"willMount");var t=e[y].render(r,i);if("object"!==(void 0===t?"undefined":_(t))||t.component||!t.tag)throw new x(e[y].name+": Component root must be a tag");e[y].dom?(e[y].dom[y]&&void 0!==e[y].dom[y].key&&(t.key=e[y].dom[y].key),U(e[y].dom,t,e)):e[y].dom=N(t,e),e[y].dom[y].id=e[y].id,e[y].mounted&&k(e,"didUpdate")}else k(e,"didUpdate")}function e(e,t){window.setImmediate(function(){e(),t&&t()})}var c=Promise.resolve();function d(e,t){return c.then(function(){e(),t&&t()})}function u(e,t){setTimeout(function(){e(),t&&t()},0)}var R=window.setImmediate?e:window.Promise?d:u,A=[],I={};function q(){A.forEach(function(e){I[e[y].id]||(D(e),I[e[y].id]=!0)}),A=[],I={}}function L(e,t){A.push(e),1===A.length&&R(q,t)}var V=function(){function h(t,e,r,o){var n=this;P(this,h);var i,s,a,c,d,u,p,f=E(),l=!1;!1!==t.scoped&&(l=t[y]?t[y].scope:w(E())),this[y]={},i=this,s=t,v.forEach(function(e){s[e]&&(i[y][e]=s[e].bind(i))}),k(this,"willCreate"),this[y].id=f,o&&(o[y].children[f]=this),this[y].name=e,this[y].factories={},this[y].parent=o,this[y].app=o?o[y].app:this,this[y].scope=l,this[y].children={},this[y].props={},this[y].subscribers={},this[y].subscriptions=t.subscriptions?t.subscriptions:[],this[y].render=t.render?t.render.bind(this):null,this[y].shouldUpdateData=m,this[y].shouldUpdateProps=b,this[y].subscriptions.forEach(function(e){var t=e.store;e.fields.forEach(function(e){t[y].data.hasOwnProperty(e)&&(t[y].subscribers[e][f]=n)})}),t.props&&(this[y].props=r||{},this[y].defaultProps=t.defaultProps,this[y].defaultProps&&(this[y].props=T({},this[y].defaultProps,this[y].props)),a=this[y].props,c=t.props,d=this,u=Object.keys(c),(p=Object.keys(a)).forEach(function(e){if(u.indexOf(e)<0)throw new x(d[y].name+": "+e+" is not acceptable component property")}),u.forEach(function(e){if(u[e]&&p.indexOf(e)<0)throw new x(d[y].name+": "+e+" is required property of the component")}),Object.keys(t.props).forEach(function(e){Object.defineProperty(n,e,{enumerable:!0,get:function(){return this[y].props[e]}})})),t.data&&(this[y].data=t.data.bind(this)(),Object.keys(this[y].data).forEach(function(r){n[y].subscribers[r]={},Object.defineProperty(n,r,{enumerable:!0,get:function(){return this[y].data[r]},set:function(e){if(this[y].shouldUpdateData(this[y].data[r],e)){this[y].data[r]=e,L(this);var t=this[y].subscribers[r];Object.keys(t).forEach(function(e){return L(t[e])})}}})})),t.components&&Object.keys(t.components).forEach(function(e){!function(e,t,o){if(!o[y]){var r=E(),n=!1!==o.scoped&&w(r);o[y]={id:r,scope:n},o.style&&O(o.style(),n),g[r]=function(e,t,r){return new V(o,e,t,r)}}e[y].factories[t]=g[o[y].id]}(n,e,t.components[e])}),t.methods&&Object.keys(t.methods).forEach(function(e){n[e]=t.methods[e].bind(n)}),k(this,"didCreate")}return t(h,[{key:"$render",value:function(){D(this)}},{key:"$data",get:function(){return T({},this[y].data)},set:function(t){var r=this;Object.keys(t).forEach(function(e){void 0!==r[y].data&&(r[e]=t[e])})}},{key:"$props",get:function(){return T({},this[y].props)}},{key:"$app",get:function(){return this[y].app}},{key:"$dom",get:function(){return this[y].dom}}]),h}();return function(e){function o(e,t){P(this,o);var r=a(this,(o.__proto__||Object.getPrototypeOf(o)).call(this,e,"modesteRoot",t));return r[y].isApp=!0,e.style&&O(e.style(),r[y].scope),r[y].wrap=e.selector?document.querySelector(e.selector):null,r.$render(),r}return s(o,V),t(o,[{key:"$render",value:function(){if(function e(t,r,o){null===t&&(t=Function.prototype);var n=Object.getOwnPropertyDescriptor(t,r);if(void 0===n){var i=Object.getPrototypeOf(t);return null===i?void 0:e(i,r,o)}if("value"in n)return n.value;var s=n.get;return void 0!==s?s.call(o):void 0}(o.prototype.__proto__||Object.getPrototypeOf(o.prototype),"$render",this).call(this),this[y].render&&!this[y].mounted){if(!this[y].wrap)return C(this);for(;this[y].wrap.firstChild;)this[y].wrap.removeChild(this[y].wrap.firstChild);this[y].wrap.appendChild(this[y].dom),C(this)}}},{key:"$wrap",get:function(){return this[y].wrap}},{key:"$props",set:function(e){$(this,e)}}]),o}()}();
//# sourceMappingURL=modeste.browser.js.map
